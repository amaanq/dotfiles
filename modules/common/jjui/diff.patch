diff --git a/flake.lock b/flake.lock
index 83716747ec..a029a37f06 100644
--- a/flake.lock
+++ b/flake.lock
@@ -5,11 +5,11 @@
         "nixpkgs-lib": "nixpkgs-lib"
       },
       "locked": {
-        "lastModified": 1768135262,
-        "narHash": "sha256-PVvu7OqHBGWN16zSi6tEmPwwHQ4rLPU9Plvs8/1TUBY=",
+        "lastModified": 1769996383,
+        "narHash": "sha256-AnYjnFWgS49RlqX7LrC4uA+sCCDBj0Ry/WOJ5XWAsa0=",
         "owner": "hercules-ci",
         "repo": "flake-parts",
-        "rev": "80daad04eddbbf5a4d883996a73f3f542fa437ac",
+        "rev": "57928607ea566b5db3ad13af0e57e921e6b12381",
         "type": "github"
       },
       "original": {
@@ -20,11 +20,11 @@
     },
     "nixpkgs": {
       "locked": {
-        "lastModified": 1768564909,
-        "narHash": "sha256-Kell/SpJYVkHWMvnhqJz/8DqQg2b6PguxVWOuadbHCc=",
+        "lastModified": 1771848320,
+        "narHash": "sha256-0MAd+0mun3K/Ns8JATeHT1sX28faLII5hVLq0L3BdZU=",
         "owner": "NixOS",
         "repo": "nixpkgs",
-        "rev": "e4bae1bd10c9c57b2cf517953ab70060a828ee6f",
+        "rev": "2fc6539b481e1d2569f25f8799236694180c0993",
         "type": "github"
       },
       "original": {
@@ -36,11 +36,11 @@
     },
     "nixpkgs-lib": {
       "locked": {
-        "lastModified": 1765674936,
-        "narHash": "sha256-k00uTP4JNfmejrCLJOwdObYC9jHRrr/5M/a/8L2EIdo=",
+        "lastModified": 1769909678,
+        "narHash": "sha256-cBEymOf4/o3FD5AZnzC3J9hLbiZ+QDT/KDuyHXVJOpM=",
         "owner": "nix-community",
         "repo": "nixpkgs.lib",
-        "rev": "2075416fcb47225d9b68ac469a5c4801a9c4dd85",
+        "rev": "72716169fe93074c333e8d0173151350670b824c",
         "type": "github"
       },
       "original": {
diff --git a/internal/config/config.go b/internal/config/config.go
index 1d85680490..fcb9cf98f3 100644
--- a/internal/config/config.go
+++ b/internal/config/config.go
@@ -17,17 +17,18 @@
 var Current = loadDefaultConfig()
 
 type Config struct {
-	BindingsProfile string          `toml:"bindings_profile"`
-	Actions         []ActionConfig  `toml:"actions"`
-	Bindings        []BindingConfig `toml:"bindings"`
-	UI              UIConfig        `toml:"ui"`
-	Suggest         SuggestConfig   `toml:"suggest"`
-	Revisions       RevisionsConfig `toml:"revisions"`
-	Preview         PreviewConfig   `toml:"preview"`
-	OpLog           OpLogConfig     `toml:"oplog"`
-	Limit           int             `toml:"limit"`
-	Git             GitConfig       `toml:"git"`
-	Ssh             SshConfig       `toml:"ssh"`
+	BindingsProfile string           `toml:"bindings_profile"`
+	Actions         []ActionConfig   `toml:"actions"`
+	Bindings        []BindingConfig  `toml:"bindings"`
+	UI              UIConfig         `toml:"ui"`
+	Suggest         SuggestConfig    `toml:"suggest"`
+	Revisions       RevisionsConfig  `toml:"revisions"`
+	Preview         PreviewConfig    `toml:"preview"`
+	OpLog           OpLogConfig      `toml:"oplog"`
+	Limit           int              `toml:"limit"`
+	Git             GitConfig        `toml:"git"`
+	Ssh             SshConfig        `toml:"ssh"`
+	DiffEditor      DiffEditorConfig `toml:"diff_editor"`
 }
 
 type Color struct {
@@ -277,3 +278,79 @@
 type SshConfig struct {
 	HijackAskpass bool `toml:"hijack_askpass"`
 }
+
+// DiffEditorConfig configures available diff tools
+type DiffEditorConfig struct {
+	// Editors is a list of available diff editors for interactive operations (split, squash -i, etc.)
+	Editors []string `toml:"editors"`
+	// Tools is a list of available diff tools for viewing (jj show, jj diff preview)
+	Tools []string `toml:"tools"`
+	// selected is the currently selected index (runtime only, not persisted)
+	// -1 means use jj default, 0+ means use the tool at that index
+	selected int
+}
+
+// GetDiffEditors returns the list of available diff editors (for interactive operations)
+func GetDiffEditors(c *Config) []string {
+	if len(c.DiffEditor.Editors) == 0 {
+		// Default editors for interactive operations
+		return []string{":builtin", "meld", "kdiff3", "vimdiff"}
+	}
+	return c.DiffEditor.Editors
+}
+
+// GetDiffTools returns the list of available diff tools (for viewing)
+func GetDiffTools(c *Config) []string {
+	if len(c.DiffEditor.Tools) == 0 {
+		// Default tools for viewing diffs
+		return []string{":color-words", ":git", "delta", "difft"}
+	}
+	return c.DiffEditor.Tools
+}
+
+// GetCurrentDiffEditor returns the currently selected diff editor for interactive operations
+func GetCurrentDiffEditor(c *Config) string {
+	if c.DiffEditor.selected < 0 {
+		return ""
+	}
+	editors := GetDiffEditors(c)
+	if c.DiffEditor.selected < len(editors) {
+		return editors[c.DiffEditor.selected]
+	}
+	return ""
+}
+
+// GetCurrentDiffTool returns the currently selected diff tool for viewing
+func GetCurrentDiffTool(c *Config) string {
+	if c.DiffEditor.selected < 0 {
+		return ""
+	}
+	tools := GetDiffTools(c)
+	if c.DiffEditor.selected < len(tools) {
+		return tools[c.DiffEditor.selected]
+	}
+	return ""
+}
+
+// SetDiffEditorIndex sets the current diff tool/editor by index
+func (c *Config) SetDiffEditorIndex(index int) {
+	tools := GetDiffTools(c)
+	if index >= -1 && index < len(tools) {
+		c.DiffEditor.selected = index
+	}
+}
+
+// CycleDiffEditor cycles to the next diff tool/editor and returns the tool name
+func (c *Config) CycleDiffEditor() string {
+	tools := GetDiffTools(c)
+	if len(tools) == 0 {
+		return ""
+	}
+	// Start from -1 (jj default), then cycle through tools, then back to -1
+	c.DiffEditor.selected++
+	if c.DiffEditor.selected >= len(tools) {
+		c.DiffEditor.selected = -1
+		return "(jj default)"
+	}
+	return tools[c.DiffEditor.selected]
+}
diff --git a/internal/config/default/config.toml b/internal/config/default/config.toml
index e569f675c3..cfdd198eb8 100644
--- a/internal/config/default/config.toml
+++ b/internal/config/default/config.toml
@@ -19,10 +19,10 @@
   # revset = "zzzzzzz"               # overrides jj's revsets.log
 
 [preview]
-  revision_command = ["show", "--color", "always", "-r", "$change_id"]
-  evolog_command = ["evolog", "--color", "always", "-r", "$commit_id", "-p", "-n", "1"]
+  revision_command = ["show", "--color", "always", "-r", "$change_id", "$diff_tool"]
+  evolog_command = ["evolog", "--color", "always", "-r", "$commit_id", "-p", "-n", "1", "$diff_tool"]
   oplog_command = ["op", "show", "$operation_id", "--color", "always"]
-  file_command = ["diff", "--color", "always", "-r", "$change_id", "$file"]
+  file_command = ["diff", "--color", "always", "-r", "$change_id", "$file", "$diff_tool"]
   position = "auto"
   show_at_start = false
   width_percentage = 50.0
@@ -36,3 +36,11 @@
 
 [ssh]
   hijack_askpass = false
+
+[diff_editor]
+  # List of diff tools for viewing (jj show, jj diff preview)
+  # Empty list uses defaults: [":color-words", ":git", "delta", "difft"]
+  tools = []
+  # List of diff editors for interactive operations (split, squash -i, etc.)
+  # Empty list uses defaults: [":builtin", "meld", "kdiff3", "vimdiff"]
+  editors = []
diff --git a/internal/config/keys.go b/internal/config/keys.go
new file mode 100644
index 0000000000..d912156bec
--- /dev/null
+++ b/internal/config/keys.go
@@ -0,0 +1,1 @@
+package config
diff --git a/internal/config/loader.go b/internal/config/loader.go
index 8e79162b5c..b8d70e8a3a 100644
--- a/internal/config/loader.go
+++ b/internal/config/loader.go
@@ -96,6 +96,9 @@
 		return err
 	}
 
+	// Initialize diff editor selection to -1 (use jj default)
+	c.DiffEditor.selected = -1
+
 	// Decode only merge-managed array/table fields into a fresh struct so these
 	// collections are always read from file content, without carrying prior state.
 	// Keep this type explicit and extend it when new merge-managed arrays are added.
diff --git a/internal/jj/commands.go b/internal/jj/commands.go
index 2e504528ac..abdddc93d1 100644
--- a/internal/jj/commands.go
+++ b/internal/jj/commands.go
@@ -15,6 +15,7 @@
 	OperationIdPlaceholder  = "$operation_id"
 	RevsetPlaceholder       = "$revset"
 	PreviewWidthPlaceholder = "$preview_width"
+	DiffToolPlaceholder     = "$diff_tool"
 
 	// user checked file names, separated by `\t` tab.
 	// tab is a lot less common than spaces on filenames,
@@ -82,8 +83,11 @@
 	return []string{"diffedit", "-r", changeId}
 }
 
-func Split(revision string, files []string, parallel bool, interactive bool) CommandArgs {
+func Split(revision string, files []string, parallel bool, interactive bool, diffEditor string) CommandArgs {
 	args := []string{"split", "-r", revision}
+	if diffEditor != "" {
+		args = append(args, "--config", fmt.Sprintf("ui.diff-editor=%s", diffEditor))
+	}
 	if parallel {
 		args = append(args, "--parallel")
 	}
@@ -135,8 +139,11 @@
 	return args
 }
 
-func Restore(revision string, files []string, interactive bool) CommandArgs {
+func Restore(revision string, files []string, interactive bool, diffEditor string) CommandArgs {
 	args := []string{"restore", "-c", revision}
+	if interactive && diffEditor != "" {
+		args = append(args, "--config", fmt.Sprintf("ui.diff-editor=%s", diffEditor))
+	}
 	if interactive {
 		args = append(args, "--interactive")
 	}
@@ -206,10 +213,13 @@
 	return args
 }
 
-func Squash(from SelectedRevisions, destination string, files []string, keepEmptied bool, useDestinationMessage bool, interactive bool, ignoreImmutable bool) CommandArgs {
+func Squash(from SelectedRevisions, destination string, files []string, keepEmptied bool, useDestinationMessage bool, interactive bool, ignoreImmutable bool, diffEditor string) CommandArgs {
 	args := []string{"squash"}
 	args = append(args, from.AsPrefixedArgs("--from")...)
 	args = append(args, "--into", destination)
+	if diffEditor != "" && interactive {
+		args = append(args, "--config", fmt.Sprintf("ui.diff-editor=%s", diffEditor))
+	}
 	if keepEmptied {
 		args = append(args, "--keep-emptied")
 	}
diff --git a/internal/parser/row.go b/internal/parser/row.go
index c109eeb8df..00a579c030 100644
--- a/internal/parser/row.go
+++ b/internal/parser/row.go
@@ -163,7 +163,8 @@
 		line.Flags = Revision | Highlightable
 		row.Commit.IsWorkingCopy = line.containsRune('@')
 		for _, segment := range line.Segments {
-			if strings.TrimSpace(segment.Text) == "hidden" {
+			trimmed := strings.TrimSpace(segment.Text)
+			if trimmed == "hidden" || trimmed == "(hidden)" {
 				row.Commit.Hidden = true
 			}
 		}
diff --git a/internal/ui/common/msgs.go b/internal/ui/common/msgs.go
index c150b7c93e..6b98582920 100644
--- a/internal/ui/common/msgs.go
+++ b/internal/ui/common/msgs.go
@@ -16,7 +16,11 @@
 		SelectedRevision string
 		KeepSelections   bool
 	}
-	ShowDiffMsg              string
+	ShowDiffMsg struct {
+		Output   string
+		Revision string // optional: for refresh support
+		FileName string // optional: for refresh support
+	}
 	UpdateRevisionsFailedMsg struct {
 		Output string
 		Err    error
diff --git a/internal/ui/context/custom_run_command.go b/internal/ui/context/custom_run_command.go
new file mode 100644
index 0000000000..a03e1d1c44
--- /dev/null
+++ b/internal/ui/context/custom_run_command.go
@@ -0,0 +1,1 @@
+package context
diff --git a/internal/ui/diff/diff.go b/internal/ui/diff/diff.go
index aa2aa5ae68..1150a13b41 100644
--- a/internal/ui/diff/diff.go
+++ b/internal/ui/diff/diff.go
@@ -1,17 +1,32 @@
 package diff
 
 import (
+	"fmt"
 	"strings"
 
 	"github.com/charmbracelet/bubbles/viewport"
 	tea "github.com/charmbracelet/bubbletea"
+	"github.com/idursun/jjui/internal/config"
+	"github.com/idursun/jjui/internal/jj"
+	"github.com/idursun/jjui/internal/ui/common"
+	"github.com/idursun/jjui/internal/ui/context"
 	"github.com/idursun/jjui/internal/ui/intents"
 	"github.com/idursun/jjui/internal/ui/layout"
 	"github.com/idursun/jjui/internal/ui/render"
 )
 
+var _ common.ImmediateModel = (*Model)(nil)
+
+// DiffSource represents the source of the diff content for refreshing
+type DiffSource struct {
+	Revision string
+	FileName string
+	Context  *context.MainContext
+}
+
 type Model struct {
-	view viewport.Model
+	view   viewport.Model
+	source *DiffSource
 }
 
 func (m *Model) Init() tea.Cmd {
@@ -68,6 +83,14 @@
 			m.view.ScrollRight(1)
 		}
 		return nil
+	case tea.KeyMsg:
+		// Handle cycle diff editor directly (unmatched keys reach here)
+		if msg.String() == "ctrl+e" && m.source != nil {
+			return m.cycleDiffTool()
+		}
+	case updateDiffContentMsg:
+		m.setContent(msg.Content)
+		return nil
 	case ScrollMsg:
 		if msg.Horizontal {
 			return nil
@@ -77,6 +100,53 @@
 	return nil
 }
 
+func (m *Model) setContent(content string) {
+	content = strings.ReplaceAll(content, "\r", "")
+	if content == "" {
+		content = "(empty)"
+	}
+	m.view.SetContent(content)
+}
+
+func (m *Model) cycleDiffTool() tea.Cmd {
+	tool := config.Current.CycleDiffEditor()
+	return tea.Batch(
+		func() tea.Msg {
+			return intents.AddMessage{Text: fmt.Sprintf("Diff tool: %s", tool)}
+		},
+		m.refreshDiff(),
+	)
+}
+
+func (m *Model) HasSource() bool {
+	return m.source != nil
+}
+
+func (m *Model) RefreshDiff() tea.Cmd {
+	return m.refreshDiff()
+}
+
+func (m *Model) refreshDiff() tea.Cmd {
+	if m.source == nil {
+		return nil
+	}
+	return func() tea.Msg {
+		diffTool := config.GetCurrentDiffTool(config.Current)
+		var args jj.CommandArgs
+		if diffTool != "" {
+			args = jj.Diff(m.source.Revision, m.source.FileName, "--config=ui.diff-formatter="+diffTool)
+		} else {
+			args = jj.Diff(m.source.Revision, m.source.FileName)
+		}
+		output, _ := m.source.Context.RunCommandImmediate(args)
+		return updateDiffContentMsg{Content: string(output)}
+	}
+}
+
+type updateDiffContentMsg struct {
+	Content string
+}
+
 func (m *Model) ViewRect(dl *render.DisplayContext, box layout.Box) {
 	m.view.Height = box.R.Dy()
 	m.view.Width = box.R.Dx()
@@ -84,7 +154,7 @@
 	dl.AddInteraction(box.R, ScrollMsg{}, render.InteractionScroll, 0)
 }
 
-func New(output string) *Model {
+func New(output string, source *DiffSource) *Model {
 	view := viewport.New(0, 0)
 	content := strings.ReplaceAll(output, "\r", "")
 	if content == "" {
@@ -92,6 +162,7 @@
 	}
 	view.SetContent(content)
 	return &Model{
-		view: view,
+		view:   view,
+		source: source,
 	}
 }
diff --git a/internal/ui/diff/diff_test.go b/internal/ui/diff/diff_test.go
index 8700eb3240..b8994a0a5b 100644
--- a/internal/ui/diff/diff_test.go
+++ b/internal/ui/diff/diff_test.go
@@ -9,16 +9,16 @@
 )
 
 func TestNew_TrimsCarriageReturnsAndHandlesEmpty(t *testing.T) {
-	model := New("line1\r\nline2\r\n")
+	model := New("line1\r\nline2\r\n", nil)
 	assert.Equal(t, "line1\nline2", test.Stripped(test.RenderImmediate(model, 20, 5)))
 
-	emptyModel := New("")
+	emptyModel := New("", nil)
 	assert.Equal(t, "(empty)", test.Stripped(test.RenderImmediate(emptyModel, 10, 3)))
 }
 
 func TestScroll_AdjustsViewportOffset(t *testing.T) {
 	content := "1\n2\n3\n4\n5\n"
-	model := New(content)
+	model := New(content, nil)
 
 	model.Scroll(2)
 	assert.Equal(t, 2, model.view.YOffset)
@@ -28,14 +28,14 @@
 }
 
 func TestUpdate_ScrollMsgStillScrolls(t *testing.T) {
-	model := New("1\n2\n3\n4\n5\n")
+	model := New("1\n2\n3\n4\n5\n", nil)
 	cmd := model.Update(ScrollMsg{Delta: 1})
 	assert.Nil(t, cmd)
 	assert.Equal(t, 1, model.view.YOffset)
 }
 
 func TestUpdate_DiffScrollIntent(t *testing.T) {
-	model := New("1\n2\n3\n4\n5\n")
+	model := New("1\n2\n3\n4\n5\n", nil)
 	model.view.Height = 3
 
 	cmd := model.Update(intents.DiffScroll{Kind: intents.DiffScrollDown})
diff --git a/internal/ui/operations/details/details.go b/internal/ui/operations/details/details.go
index b47e7f7451..4754b78207 100644
--- a/internal/ui/operations/details/details.go
+++ b/internal/ui/operations/details/details.go
@@ -13,6 +13,7 @@
 	tea "github.com/charmbracelet/bubbletea"
 	"github.com/charmbracelet/lipgloss"
 	"github.com/charmbracelet/x/cellbuf"
+	"github.com/idursun/jjui/internal/config"
 	"github.com/idursun/jjui/internal/jj"
 	"github.com/idursun/jjui/internal/ui/actions"
 	keybindings "github.com/idursun/jjui/internal/ui/bindings"
@@ -178,9 +179,15 @@
 		if selected == nil {
 			return nil
 		}
+		changeId := s.revision.GetChangeId()
+		fileName := selected.fileName
 		return func() tea.Msg {
-			output, _ := s.context.RunCommandImmediate(jj.Diff(s.revision.GetChangeId(), selected.fileName))
-			return common.ShowDiffMsg(output)
+			output, _ := s.context.RunCommandImmediate(jj.Diff(changeId, fileName))
+			return common.ShowDiffMsg{
+				Output:   string(output),
+				Revision: changeId,
+				FileName: fileName,
+			}
 		}
 	case intents.DetailsSplit:
 		selectedFiles := s.getSelectedFiles(true)
@@ -190,10 +197,10 @@
 			[]string{"Are you sure you want to split the selected files?"},
 			confirmation.WithStylePrefix("revisions"),
 			confirmation.WithOption("Yes",
-				tea.Batch(s.context.RunInteractiveCommand(jj.Split(s.revision.GetChangeId(), selectedFiles, intent.IsParallel, false), common.Refresh), common.Close),
+				tea.Batch(s.context.RunInteractiveCommand(jj.Split(s.revision.GetChangeId(), selectedFiles, intent.IsParallel, false, config.GetCurrentDiffEditor(config.Current)), common.Refresh), common.Close),
 				key.NewBinding(key.WithKeys("y"), key.WithHelp("y", "yes"))),
 			confirmation.WithOption("Interactive",
-				tea.Batch(s.context.RunInteractiveCommand(jj.Split(s.revision.GetChangeId(), selectedFiles, intent.IsParallel, true), common.Refresh), common.Close),
+				tea.Batch(s.context.RunInteractiveCommand(jj.Split(s.revision.GetChangeId(), selectedFiles, intent.IsParallel, true, config.GetCurrentDiffEditor(config.Current)), common.Refresh), common.Close),
 				key.NewBinding(key.WithKeys("i"), key.WithHelp("i", "interactive"))),
 			confirmation.WithOption("No",
 				confirmation.Close,
@@ -216,10 +223,10 @@
 			[]string{"Are you sure you want to restore the selected files?"},
 			confirmation.WithStylePrefix("revisions"),
 			confirmation.WithOption("Yes",
-				tea.Batch(s.context.RunCommand(jj.Restore(s.revision.GetChangeId(), selectedFiles, false), common.Refresh), confirmation.Close),
+				tea.Batch(s.context.RunCommand(jj.Restore(s.revision.GetChangeId(), selectedFiles, false, ""), common.Refresh), confirmation.Close),
 				key.NewBinding(key.WithKeys("y"), key.WithHelp("y", "yes"))),
 			confirmation.WithOption("Interactive",
-				tea.Batch(s.context.RunInteractiveCommand(jj.Restore(s.revision.GetChangeId(), selectedFiles, true), common.Refresh), common.Close),
+				tea.Batch(s.context.RunInteractiveCommand(jj.Restore(s.revision.GetChangeId(), selectedFiles, true, config.GetCurrentDiffEditor(config.Current)), common.Refresh), common.Close),
 				key.NewBinding(key.WithKeys("i"), key.WithHelp("i", "interactive"))),
 			confirmation.WithOption("No",
 				confirmation.Close,
diff --git a/internal/ui/operations/details/details_test.go b/internal/ui/operations/details/details_test.go
index 9508a6393d..59b482d829 100644
--- a/internal/ui/operations/details/details_test.go
+++ b/internal/ui/operations/details/details_test.go
@@ -39,7 +39,7 @@
 	commandRunner := test.NewTestCommandRunner(t)
 	commandRunner.Expect(jj.Snapshot())
 	commandRunner.Expect(jj.Status(Revision)).SetOutput([]byte(StatusOutput))
-	commandRunner.Expect(jj.Restore(Revision, []string{"file.txt"}, false))
+	commandRunner.Expect(jj.Restore(Revision, []string{"file.txt"}, false, ""))
 	defer commandRunner.Verify()
 
 	model := NewOperation(test.NewTestContext(commandRunner), Commit)
@@ -55,7 +55,7 @@
 	commandRunner := test.NewTestCommandRunner(t)
 	commandRunner.Expect(jj.Snapshot())
 	commandRunner.Expect(jj.Status(Revision)).SetOutput([]byte(StatusOutput))
-	commandRunner.Expect(jj.Restore(Revision, []string{"file.txt"}, true))
+	commandRunner.Expect(jj.Restore(Revision, []string{"file.txt"}, true, ""))
 	defer commandRunner.Verify()
 
 	model := NewOperation(test.NewTestContext(commandRunner), Commit)
@@ -71,7 +71,7 @@
 	commandRunner := test.NewTestCommandRunner(t)
 	commandRunner.Expect(jj.Snapshot())
 	commandRunner.Expect(jj.Status(Revision)).SetOutput([]byte(StatusOutput))
-	commandRunner.Expect(jj.Split(Revision, []string{"file.txt"}, false, false))
+	commandRunner.Expect(jj.Split(Revision, []string{"file.txt"}, false, false, ""))
 	defer commandRunner.Verify()
 
 	model := NewOperation(test.NewTestContext(commandRunner), Commit)
@@ -87,7 +87,7 @@
 	commandRunner := test.NewTestCommandRunner(t)
 	commandRunner.Expect(jj.Snapshot())
 	commandRunner.Expect(jj.Status(Revision)).SetOutput([]byte(StatusOutput))
-	commandRunner.Expect(jj.Split(Revision, []string{"file.txt"}, true, false))
+	commandRunner.Expect(jj.Split(Revision, []string{"file.txt"}, true, false, ""))
 	defer commandRunner.Verify()
 
 	model := NewOperation(test.NewTestContext(commandRunner), Commit)
@@ -103,7 +103,7 @@
 	commandRunner := test.NewTestCommandRunner(t)
 	commandRunner.Expect(jj.Snapshot())
 	commandRunner.Expect(jj.Status(Revision)).SetOutput([]byte("false false $\nR internal/ui/{revisions => }/file.go\nR {file => sub/newfile}\n"))
-	commandRunner.Expect(jj.Restore(Revision, []string{"internal/ui/file.go", "sub/newfile"}, false))
+	commandRunner.Expect(jj.Restore(Revision, []string{"internal/ui/file.go", "sub/newfile"}, false, ""))
 	defer commandRunner.Verify()
 
 	model := NewOperation(test.NewTestContext(commandRunner), Commit)
@@ -120,7 +120,7 @@
 	commandRunner := test.NewTestCommandRunner(t)
 	commandRunner.Expect(jj.Snapshot())
 	commandRunner.Expect(jj.Status(Revision)).SetOutput([]byte("false false false $\nR {src/new_file_3.md => new_file.md}\nR src/{new_file.py => renamed_py.py}\nR {src1/to_be_renamed.md => src2/renamed.md}\n"))
-	commandRunner.Expect(jj.Restore(Revision, []string{"new_file.md", "src/renamed_py.py", "src2/renamed.md"}, false))
+	commandRunner.Expect(jj.Restore(Revision, []string{"new_file.md", "src/renamed_py.py", "src2/renamed.md"}, false, ""))
 	defer commandRunner.Verify()
 
 	model := NewOperation(test.NewTestContext(commandRunner), Commit)
@@ -138,7 +138,7 @@
 	commandRunner := test.NewTestCommandRunner(t)
 	commandRunner.Expect(jj.Snapshot())
 	commandRunner.Expect(jj.Status(Revision)).SetOutput([]byte("false false $\nM file{with}braces.txt\nA another{test}.go\n"))
-	commandRunner.Expect(jj.Restore(Revision, []string{"file{with}braces.txt", "another{test}.go"}, false))
+	commandRunner.Expect(jj.Restore(Revision, []string{"file{with}braces.txt", "another{test}.go"}, false, ""))
 	defer commandRunner.Verify()
 
 	model := NewOperation(test.NewTestContext(commandRunner), Commit)
diff --git a/internal/ui/operations/evolog/evolog_operation.go b/internal/ui/operations/evolog/evolog_operation.go
index ace0736098..6a0f421cf9 100644
--- a/internal/ui/operations/evolog/evolog_operation.go
+++ b/internal/ui/operations/evolog/evolog_operation.go
@@ -146,10 +146,13 @@
 		if o.mode != selectMode {
 			return nil
 		}
+		selectedCommitId := o.getSelectedEvolog().CommitId
 		return func() tea.Msg {
-			selectedCommitId := o.getSelectedEvolog().CommitId
 			output, _ := o.context.RunCommandImmediate(jj.Diff(selectedCommitId, ""))
-			return common.ShowDiffMsg(output)
+			return common.ShowDiffMsg{
+				Output:   string(output),
+				Revision: selectedCommitId,
+			}
 		}
 	case intents.EvologRestore:
 		if o.mode != selectMode {
diff --git a/internal/ui/operations/squash/squash_operation.go b/internal/ui/operations/squash/squash_operation.go
index 2ec1e68fea..c06b82fd8e 100644
--- a/internal/ui/operations/squash/squash_operation.go
+++ b/internal/ui/operations/squash/squash_operation.go
@@ -7,6 +7,7 @@
 	tea "github.com/charmbracelet/bubbletea"
 	"github.com/charmbracelet/lipgloss"
 	"github.com/charmbracelet/x/cellbuf"
+	"github.com/idursun/jjui/internal/config"
 	"github.com/idursun/jjui/internal/jj"
 	"github.com/idursun/jjui/internal/ui/actions"
 	keybindings "github.com/idursun/jjui/internal/ui/bindings"
@@ -96,7 +97,7 @@
 	case intents.StartAceJump:
 		return common.StartAceJump()
 	case intents.Apply:
-		args := jj.Squash(s.from, s.targetArg(), s.files, s.keepEmptied, s.useDestinationMessage, s.interactive, intent.Force)
+		args := jj.Squash(s.from, s.targetArg(), s.files, s.keepEmptied, s.useDestinationMessage, s.interactive, intent.Force, config.GetCurrentDiffEditor(config.Current))
 		continuation := common.RefreshAndSelect(s.current.GetChangeId())
 		if s.interactive || !s.useDestinationMessage {
 			return tea.Batch(common.Close, s.context.RunInteractiveCommand(args, continuation))
diff --git a/internal/ui/oplog/operation_log.go b/internal/ui/oplog/operation_log.go
index 3c8047b9d1..c4b575d30c 100644
--- a/internal/ui/oplog/operation_log.go
+++ b/internal/ui/oplog/operation_log.go
@@ -194,7 +194,8 @@
 	}
 	return func() tea.Msg {
 		output, _ := m.context.RunCommandImmediate(jj.OpShow(opId))
-		return common.ShowDiffMsg(output)
+		// oplog diffs don't support cycling since they use jj op show
+		return common.ShowDiffMsg{Output: string(output)}
 	}
 }
 
diff --git a/internal/ui/preview/preview.go b/internal/ui/preview/preview.go
index 7f04931f12..167af90cb9 100644
--- a/internal/ui/preview/preview.go
+++ b/internal/ui/preview/preview.go
@@ -169,8 +169,12 @@
 }
 
 func (m *Model) SetContent(content string) {
+	normalized := strings.ReplaceAll(content, "\r", "")
+	if normalized == m.content {
+		return
+	}
 	m.reset()
-	m.content = strings.ReplaceAll(content, "\r", "")
+	m.content = normalized
 	m.view.SetContent(content)
 }
 
@@ -196,6 +200,11 @@
 	return common.Debounce(debounceId, debounceDuration, func() tea.Msg {
 		var args []string
 		previewWidth := strconv.Itoa(m.view.Width)
+		diffTool := config.GetCurrentDiffTool(config.Current)
+		diffToolArg := ""
+		if diffTool != "" {
+			diffToolArg = "--config=ui.diff-formatter=" + diffTool
+		}
 		switch sel := item.(type) {
 		case common.SelectedFile:
 			args = jj.TemplatedArgs(config.Current.Preview.FileCommand, map[string]string{
@@ -204,6 +213,7 @@
 				jj.CommitIdPlaceholder:     sel.CommitId,
 				jj.FilePlaceholder:         sel.File,
 				jj.PreviewWidthPlaceholder: previewWidth,
+				jj.DiffToolPlaceholder:     diffToolArg,
 			})
 		case common.SelectedRevision:
 			args = jj.TemplatedArgs(config.Current.Preview.RevisionCommand, map[string]string{
@@ -211,22 +221,33 @@
 				jj.ChangeIdPlaceholder:     sel.ChangeId,
 				jj.CommitIdPlaceholder:     sel.CommitId,
 				jj.PreviewWidthPlaceholder: previewWidth,
+				jj.DiffToolPlaceholder:     diffToolArg,
 			})
 		case common.SelectedCommit:
 			args = jj.TemplatedArgs(config.Current.Preview.EvologCommand, map[string]string{
 				jj.RevsetPlaceholder:       m.context.CurrentRevset,
 				jj.CommitIdPlaceholder:     sel.CommitId,
 				jj.PreviewWidthPlaceholder: previewWidth,
+				jj.DiffToolPlaceholder:     diffToolArg,
 			})
 		case common.SelectedOperation:
 			args = jj.TemplatedArgs(config.Current.Preview.OplogCommand, map[string]string{
 				jj.RevsetPlaceholder:       m.context.CurrentRevset,
 				jj.OperationIdPlaceholder:  sel.OperationId,
 				jj.PreviewWidthPlaceholder: previewWidth,
+				jj.DiffToolPlaceholder:     diffToolArg,
 			})
 		}
 
-		output, _ := m.context.RunCommandImmediate(args)
+		// Filter out empty args (e.g., when $diff_tool is not set)
+		filteredArgs := args[:0]
+		for _, arg := range args {
+			if arg != "" {
+				filteredArgs = append(filteredArgs, arg)
+			}
+		}
+
+		output, _ := m.context.RunCommandImmediate(filteredArgs)
 		return updatePreviewContentMsg{
 			Content: string(output),
 		}
diff --git a/internal/ui/revisions/displaycontext_renderer.go b/internal/ui/revisions/displaycontext_renderer.go
index ba2b255717..ed2710bab4 100644
--- a/internal/ui/revisions/displaycontext_renderer.go
+++ b/internal/ui/revisions/displaycontext_renderer.go
@@ -7,7 +7,6 @@
 	"github.com/charmbracelet/x/cellbuf"
 	"github.com/idursun/jjui/internal/parser"
 	"github.com/idursun/jjui/internal/screen"
-	"github.com/idursun/jjui/internal/ui/common"
 	"github.com/idursun/jjui/internal/ui/layout"
 	"github.com/idursun/jjui/internal/ui/operations"
 	"github.com/idursun/jjui/internal/ui/render"
@@ -158,10 +157,7 @@
 		clickMsg,
 	)
 
-	// Register scroll only when no overlay operation is active
-	if overlay, ok := operation.(common.Overlay); !ok || !overlay.IsOverlay() {
-		r.listRenderer.RegisterScroll(dl, viewRect)
-	}
+	r.listRenderer.RegisterScroll(dl, viewRect)
 }
 
 // addHighlights adds highlight effects for lines with Highlightable flag
diff --git a/internal/ui/revisions/revisions.go b/internal/ui/revisions/revisions.go
index bb9b74e3f3..1cbc726ce4 100644
--- a/internal/ui/revisions/revisions.go
+++ b/internal/ui/revisions/revisions.go
@@ -812,7 +812,10 @@
 	changeId := commit.GetChangeId()
 	return func() tea.Msg {
 		output, _ := m.context.RunCommandImmediate(jj.Diff(changeId, ""))
-		return common.ShowDiffMsg(output)
+		return common.ShowDiffMsg{
+			Output:   string(output),
+			Revision: changeId,
+		}
 	}
 }
 
@@ -824,7 +827,7 @@
 	if commit == nil {
 		return nil
 	}
-	return m.context.RunInteractiveCommand(jj.Split(commit.GetChangeId(), intent.Files, intent.IsParallel, intent.IsInteractive), common.Refresh)
+	return m.context.RunInteractiveCommand(jj.Split(commit.GetChangeId(), intent.Files, intent.IsParallel, intent.IsInteractive, config.GetCurrentDiffEditor(config.Current)), common.Refresh)
 }
 
 func (m *Model) updateSelection() tea.Cmd {
diff --git a/internal/ui/ui.go b/internal/ui/ui.go
index 01ab78a832..7ce4d09108 100644
--- a/internal/ui/ui.go
+++ b/internal/ui/ui.go
@@ -165,7 +165,15 @@
 	case common.ExecProcessCompletedMsg:
 		cmds = append(cmds, common.Refresh)
 	case common.ShowDiffMsg:
-		m.diff = diff.New(string(msg))
+		var source *diff.DiffSource
+		if msg.Revision != "" {
+			source = &diff.DiffSource{
+				Revision: msg.Revision,
+				FileName: msg.FileName,
+				Context:  m.context,
+			}
+		}
+		m.diff = diff.New(msg.Output, source)
 		return m.diff.Init()
 	case common.UpdateRevisionsSuccessMsg:
 		m.state = common.Ready
@@ -743,6 +751,11 @@
 }
 
 func (m *Model) handleUnmatched(msg tea.KeyMsg) tea.Cmd {
+	// Global cycle diff editor shortcut
+	if msg.String() == "ctrl+e" && !m.status.IsFocused() && !m.revsetModel.Editing {
+		return m.cycleDiffEditor()
+	}
+
 	if m.status.IsFocused() {
 		return m.status.Update(msg)
 	}
@@ -764,6 +777,20 @@
 	return m.revisions.Update(msg)
 }
 
+func (m *Model) cycleDiffEditor() tea.Cmd {
+	tool := config.Current.CycleDiffEditor()
+	cmds := []tea.Cmd{
+		func() tea.Msg {
+			return intents.AddMessage{Text: fmt.Sprintf("Diff tool: %s", tool)}
+		},
+	}
+	if m.diff != nil && m.diff.HasSource() {
+		cmds = append(cmds, m.diff.RefreshDiff())
+	}
+	cmds = append(cmds, common.SelectionChanged(m.context.SelectedItem))
+	return tea.Batch(cmds...)
+}
+
 func (m *Model) primaryScope() keybindings.Scope {
 	if m.password != nil {
 		return scopePassword
